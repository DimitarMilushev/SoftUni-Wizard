<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <link rel="stylesheet" href="style.css">
   <title>SoftUni Wizard</title>
</head>
<body>
    <div class="game-section">
        <!-- breaks after the 10th digin -->
        <div class="game-score"><span class="points">0</span> pts</div>
        <div class="game-start">PRESS TO PLAY!</div>
        <div class="game-area"></div>
        <div class="game-over"></div>
    </div>

    <script>
        const gameStart = document.querySelector('.game-start');
        const gameArea = document.querySelector('.game-area');
        const gameScore = document.querySelector('.game-score');
        const gameOver = document.querySelector('.game-over');
        const gamePoints = gameScore.querySelector('.points');

        gameStart.addEventListener("click", onGameStart);
        document.addEventListener("keydown", onKeyDown);
        document.addEventListener("keyup", onKeyUp);

        let keys = {};
        
        let player = {
            x: 300,
            y: 200,
            width: 0,
            height: 0 
        };
        let game = {
            speed: 10,
            struggle: 3
        };
        let scene = {
            score: 0,
            isActiveGame: true,
            height: gameArea.offsetHeight,
            width: gameArea.offsetWidth
        };

        function onGameStart() {
            gameStart.classList.add("hide");

            const wizard = document.createElement("div")
            // Initial position
            wizard.style.top = player.y + "px";
            wizard.style.left = player.x + "px";
            wizard.classList.add("wizard");
            gameArea.appendChild(wizard);
            player.height = wizard.offsetHeight;
            player.width = wizard.offsetWidth;

            window.requestAnimationFrame(gameAction);
        }

        function gameAction(timestamp) {

          const wizard = document.querySelector(".wizard");
          scene.score++;

          let isInAir = (player.y + player.height) <= scene.height;
          if(isInAir) {

            player.y += game.struggle;          
          }

          if(keys.ArrowUp && player.y > 0) {

              player.y -= game.speed - game.struggle;
          }
          if(keys.ArrowDown && player.y < 0) {

              player.y += game.speed;
          }
          if(keys.ArrowLeft && player.x > 0) {

              player.x -= game.speed;
          }
          if(keys.ArrowRight && player.x < scene.width / 2.5) {

              player.x += game.speed;
          }

          wizard.style.top = player.y + "px";
          wizard.style.left = player.x + "px";

          gamePoints.textContent = scene.score;
          
          if (scene.isActiveGame) {
               window.requestAnimationFrame(gameAction);
            }
        }

        function onKeyDown(e) {
        
         keys[e.code] = true;
        }

        function onKeyUp(e) {

         keys[e.code] = false;
        }

    </script>
</body>
</html>